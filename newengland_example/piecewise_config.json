{ 
    "piecewise_version" : "1.0",
    "database_uri" : "postgresql+psycopg2://postgres:@/piecewise",
    "cache_table_name": "results",
    "aggregations": [{
        "name": "by_county",
        "statistics_table_name": "county_statistics",
        "bins": [
            { "type" : "spatial_join", "table" : "newengland", "geometry_column" : "wkb_geometry", "key" : "geoid", "key_type" : "string" ,"join_custom_data" : true },
            { "type" : "time_slices", "resolution" : "day" },
            { "type" : "isp_bins", "maxmind_table" : "maxmind", 
                "rewrites" : {
                    "twc": ["Time Warner"],
                    "centurylink": ["Qwest", "Embarq", "Centurylink", "Centurytel"],
                    "level3": ["Level 3 Communications", "GBLX"],
                    "cablevision": ["Cablevision Systems", "CSC Holdings", "Cablevision Infrastructure", "Cablevision Corporate", "Optimum Online", "Optimum WiFi", "Optimum Network"],
		    "rcn" : ["RCN", "IRCN Ltd"],
		    "charter" : ["Charter Communications"],
		    "meganet" : ["JSC Meganet", "megaNET network", "Meganet-2003 LLC", "Meganet Communications", "MegaNet"],
		    "verizon" : ["Verizon Data Services LLC", "MCI Communications Services, Inc. d/b/a Verizon Business", "Verizon Nederland B.V.", "Verizon UK Limited", "Verizon Online LLC", "Cellco Partnership DBA Verizon Wireless", "Verizon Australia PTY Limited", "Verizon Business Network Services Inc."],
		    "recol" : ["Recol"],
		    "netplex" : ["NETPLEX"],
		    "fullchannel":["Full Channel Inc."],
		    "datanet":["DATANET LLC", "DataNetworks s.r.o.", "DATANET SYSTEMS SRL"],
		    "powershift":["Power Shift Computer Services, Inc."],
		    "greenmnt":["GREEN MOUNTAIN COFFEE ROASTERS, INC."],
		    "pioneer":["Pioneer Internet","Pioneer Broadband","Pioneer Long Distance Inc.","LLC PioneerNet","Pioneer Cellular","Pioneer Hi-Bred International, Inc.","Pioneer Elabs Ltd.","Pioneer Balloon Co.","PIONEER STATE MUTUAL INSURANCE CO."],
		    "wave":["WaveCom AS"]
                } }
        ],
        "statistics": [
            { "type" : "AverageRTT" },
            { "type" : "MedianRTT" },
            { "type" : "DownloadCount" },
            { "type" : "AverageDownload" },
            { "type" : "MedianDownload" },
            { "type" : "UploadCount" },
            { "type" : "AverageUpload" },
            { "type" : "MedianUpload" }
        ]
    }],
    "filters": [
        { "type": "temporal", "after": "Jan 1 2014 00:00:00", "before" : "Apr 1 2015 00:00:00" },
        { "type": "bbox", "bbox": [-73.804831028,40.9328920598,-66.8516998291,47.4672094343] },
        { "type": "raw", "query": "web100_log_entry.snap.CongSignals > 0" },
        { "type": "raw", "query": "web100_log_entry.is_last_entry == true" },
        { "type": "raw", "query": "project == 0" },
        { "type": "raw", "query": "web100_log_entry.snap.SndLimTimeSnd IS NOT NULL" },
        { "type": "raw", "query": "web100_log_entry.snap.SndLimTimeCwnd IS NOT NULL" },
        { "type": "raw", "query": "web100_log_entry.snap.SndLimTimeRwin IS NOT NULL" },
        { "type": "raw", "query": "web100_log_entry.snap.CountRTT > 0" },
        { "type": "raw", "query": "web100_log_entry.snap.HCThruOctetsAcked >= 8192" },
        { "type": "raw", "query": "(web100_log_entry.snap.State == 1 OR (web100_log_entry.snap.State >= 5 AND web100_log_entry.snap.State <= 11))" },
        { "type": "raw", "query": "(web100_log_entry.snap.SndLimTimeRwin + web100_log_entry.snap.SndLimTimeCwnd + web100_log_entry.snap.SndLimTimeSnd) >= 9000000" },
        { "type": "raw", "query": "(web100_log_entry.snap.SndLimTimeRwin + web100_log_entry.snap.SndLimTimeCwnd + web100_log_entry.snap.SndLimTimeSnd) < 3600000000" }
    ]
}
